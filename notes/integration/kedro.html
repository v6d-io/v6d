<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Kedro Vineyard Plugin" />
<meta property="og:type" content="website" />
<meta property="og:url" content="notes/integration/kedro.html" />
<meta property="og:site_name" content="vineyard" />
<meta property="og:description" content="The Kedro vineyard plugin contains components (e.g., DataSet and Runner) to share intermediate data among nodes in Kedro pipelines using vineyard. Kedro on Vineyard: Vineyard works as the DataSet p..." />
<meta name="description" content="The Kedro vineyard plugin contains components (e.g., DataSet and Runner) to share intermediate data among nodes in Kedro pipelines using vineyard. Kedro on Vineyard: Vineyard works as the DataSet p..." />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="API Reference" href="../references.html" /><link rel="prev" title="Airflow on Vineyard" href="airflow.html" />

    <link rel="shortcut icon" href="../../_static/vineyard.ico"/><!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Kedro Vineyard Plugin - Vineyard</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-dropdown.css?v=995e94df" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-bootstrap.min.css?v=21c0b90a" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/brands.min.css?v=af964456" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/v4-shims.min.css?v=e329b598" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=11f00004" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/panels.css?v=0f22cee4" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/index.css?v=c31c8fd8" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
<script>
  document.body.dataset.theme = "light";
</script>

<script>
  function ready(callback) {
    if (document.readyState!='loading') {
      // in case the document is already rendered
      callback();
    } else if (document.addEventListener) {
      // modern browsers
      document.addEventListener('DOMContentLoaded', callback);
    } else document.attachEvent('onreadystatechange', function() {
      // IE <= 8
      if (document.readyState=='complete') {
        callback();
      }
    });
  }

  ready(function() {
    let coll = document.getElementsByClassName("admonition-details");
    for (let i = 0; i < coll.length; i++) {
      let titles = coll[i].getElementsByClassName("admonition-title");
      if (titles.length == 0) {
        continue;
      }
      titles[0].addEventListener("click", function () {
        this.parentElement.classList.toggle("active");

        if (this.parentElement.classList.contains("active")) {
          this.getElementsByClassName("admonition-caret")[0].innerText = " - (click to collapse)";
        } else {
          this.getElementsByClassName("admonition-caret")[0].innerText = " + (click to expand)";
        }
      });
      titles[0].appendChild(document.createElement("br"));
      let caret = document.createElement("span");
      caret.classList.add("admonition-caret");
      caret.innerText = " + (click to expand)";
      titles[0].appendChild(caret);
    }
  });
</script>


<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../docs.html"><div class="brand">Vineyard</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../docs.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/vineyard-logo-h.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">Architecture</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../key-concepts.html">Key Concepts</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Key Concepts</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../key-concepts/objects.html">Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../key-concepts/vcdl.html">Code Generation for Boilerplate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../key-concepts/data-accessing.html">Data Accessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../key-concepts/streams.html">Streams in Vineyard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../key-concepts/io-drivers.html">I/O Drivers</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Cloud-Native</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cloud-native/deploy-kubernetes.html">Deploy on Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cloud-native/vineyard-operator.html">Vineyard Operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cloud-native/vineyardctl.html">Command-line tool</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/data-processing.html">Data processing</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Data processing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/data-processing/using-objects-python.html">Sharing Python Objects with Vineyard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/data-processing/python-sharedmemory.html"><code class="code docutils literal notranslate"><span class="pre">multiprocessing.shared_memory</span></code> in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/data-processing/distributed-learning.html">Distributed Learning with Vineyard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/data-processing/accelerate-data-sharing-in-kedro.html">Accelerate Data Sharing in Kedro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/data-processing/gpu-memory-sharing.html">Sharing GPU Memory</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/kubernetes.html">Vineyard on Kubernetes</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Vineyard on Kubernetes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/kubernetes/using-vineyard-operator.html">Use vineyard operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/kubernetes/ml-pipeline-mars-pytorch.html">Machine learning with Vineyard on Kubernetes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/kubernetes/data-sharing-with-vineyard-on-kubernetes.html">Data sharing with Vineyard on Kubernetes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/kubernetes/efficient-data-sharing-in-kubeflow-with-vineyard-csi-driver.html">Efficient data sharing in Kubeflow with Vineyard CSI Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/kubernetes/vineyard-on-fluid.html">Vineyard + Fluid in Action: Train a Linear Regression Model on ACK</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/extending.html">Extending vineyard</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Extending vineyard</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/extending/define-datatypes-python.html">Define Data Types in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/extending/define-datatypes-cpp.html">Defining Custom Data Types in C++</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Integration</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../integration-bigdata.html">Big-data on Vineyard</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Big-data on Vineyard</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="dask.html">Dask on Vineyard</a></li>
<li class="toctree-l2"><a class="reference internal" href="ml.html">Machine Learning with Vineyard</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../integration-orchestration.html">Workflow orchestration</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Workflow orchestration</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="airflow.html">Airflow on Vineyard</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal">Kedro Vineyard Plugin</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../references.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../references/python-api.html">Python API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references/cpp-api.html">C++ API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references/crds.html">Kubernetes CRDs</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guides</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../developers.html">Getting Involved</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Getting Involved</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../developers/build-from-source.html">Building from source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developers/contributing.html">Contributing to vineyard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developers/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developers/roadmap.html">Roadmap</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developers/faq.html">Frequently Asked Questions</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/v6d-io/v6d/blob/main/docs/notes/integration/kedro.md?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/v6d-io/v6d/edit/main/docs/notes/integration/kedro.md" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="kedro-vineyard-plugin">
<h1>Kedro Vineyard Plugin<a class="headerlink" href="#kedro-vineyard-plugin" title="Link to this heading">¶</a></h1>
<p>The Kedro vineyard plugin contains components (e.g., <code class="docutils literal notranslate"><span class="pre">DataSet</span></code> and <code class="docutils literal notranslate"><span class="pre">Runner</span></code>)
to share intermediate data among nodes in Kedro pipelines using vineyard.</p>
<section id="kedro-on-vineyard">
<h2>Kedro on Vineyard<a class="headerlink" href="#kedro-on-vineyard" title="Link to this heading">¶</a></h2>
<p>Vineyard works as the <em>DataSet</em> provider for kedro workers to allow transferring
large-scale data objects between tasks that cannot be efficiently serialized and
is not suitable for <code class="docutils literal notranslate"><span class="pre">pickle</span></code>, without involving external storage systems like
AWS S3 (or Minio as an alternative). The Kedro vineyard plugin handles object migration
as well when the required inputs are not located where the task is scheduled to execute.</p>
</section>
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Link to this heading">¶</a></h2>
<p>The following packages are needed to run Kedro on vineyard,</p>
<ul class="simple">
<li><p>kedro &gt;= 0.18</p></li>
<li><p>vineyard &gt;= 0.14.5</p></li>
</ul>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h2>
<ol class="arabic">
<li><p>Install required packages:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pip3 install vineyard-kedro
</pre></div>
</div>
</li>
<li><p>Configure Vineyard locally</p>
<p>The vineyard server can be easier launched locally with the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>python3 -m vineyard --socket=/tmp/vineyard.sock
</pre></div>
</div>
<p>See also our documentation about <a class="reference external" href="https://v6d.io/notes/getting-started.html#starting-vineyard-server">Launching Vineyard</a>.</p>
</li>
<li><p>Configure the environment variable to tell Kedro vineyard plugin how to connect to the
vineyardd server:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>export VINEYARD_IPC_SOCKET=/tmp/vineyard.sock
</pre></div>
</div>
</li>
</ol>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p>After installing the dependencies and preparing the vineyard server, you can execute the
Kedro workflows as usual and benefits from vineyard for intermediate data sharing.</p>
<p>We take the <a class="reference external" href="https://docs.kedro.org/en/stable/get_started/new_project.html">Iris example</a> as an example,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>kedro<span class="w"> </span>new<span class="w"> </span>--starter<span class="o">=</span>pandas-iris
</pre></div>
</div>
<p>The nodes in this pipeline look like</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">split_data</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
    <span class="n">data_train</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
        <span class="n">frac</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;train_fraction&quot;</span><span class="p">],</span> <span class="n">random_state</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;random_state&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">data_test</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">data_train</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="n">X_train</span> <span class="o">=</span> <span class="n">data_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;target_column&quot;</span><span class="p">])</span>
    <span class="n">X_test</span> <span class="o">=</span> <span class="n">data_test</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;target_column&quot;</span><span class="p">])</span>
    <span class="n">y_train</span> <span class="o">=</span> <span class="n">data_train</span><span class="p">[</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;target_column&quot;</span><span class="p">]]</span>
    <span class="n">y_test</span> <span class="o">=</span> <span class="n">data_test</span><span class="p">[</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;target_column&quot;</span><span class="p">]]</span>

    <span class="k">return</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span>


<span class="k">def</span><span class="w"> </span><span class="nf">make_predictions</span><span class="p">(</span>
    <span class="n">X_train</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">X_test</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">y_train</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
    <span class="n">X_train_numpy</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">X_test_numpy</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

    <span class="n">squared_distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
        <span class="p">(</span><span class="n">X_train_numpy</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">X_test_numpy</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span>
    <span class="p">)</span>
    <span class="n">nearest_neighbour</span> <span class="o">=</span> <span class="n">squared_distances</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">nearest_neighbour</span><span class="p">]</span>
    <span class="n">y_pred</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">index</span>

    <span class="k">return</span> <span class="n">y_pred</span>
</pre></div>
</div>
<p>You can see that the intermediate data between <code class="docutils literal notranslate"><span class="pre">split_data</span></code> and <code class="docutils literal notranslate"><span class="pre">make_predictions</span></code> is some pandas
dataframes and series.</p>
<p>Try running the pipeline without vineyard,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>iris
$<span class="w"> </span>kedro<span class="w"> </span>run
<span class="o">[</span><span class="m">05</span>/25/23<span class="w"> </span><span class="m">11</span>:38:56<span class="o">]</span><span class="w"> </span>INFO<span class="w">     </span>Kedro<span class="w"> </span>project<span class="w"> </span>iris<span class="w">                                                                                       </span>session.py:355
<span class="o">[</span><span class="m">05</span>/25/23<span class="w"> </span><span class="m">11</span>:38:57<span class="o">]</span><span class="w"> </span>INFO<span class="w">     </span>Loading<span class="w"> </span>data<span class="w"> </span>from<span class="w"> </span><span class="s1">&#39;example_iris_data&#39;</span><span class="w"> </span><span class="o">(</span>CSVDataSet<span class="o">)</span>...<span class="w">                                               </span>data_catalog.py:343
<span class="w">                    </span>INFO<span class="w">     </span>Loading<span class="w"> </span>data<span class="w"> </span>from<span class="w"> </span><span class="s1">&#39;parameters&#39;</span><span class="w"> </span><span class="o">(</span>MemoryDataSet<span class="o">)</span>...<span class="w">                                                   </span>data_catalog.py:343
<span class="w">                    </span>INFO<span class="w">     </span>Running<span class="w"> </span>node:<span class="w"> </span>split:<span class="w"> </span>split_data<span class="o">([</span>example_iris_data,parameters<span class="o">])</span><span class="w"> </span>-&gt;<span class="w"> </span><span class="o">[</span>X_train,X_test,y_train,y_test<span class="o">]</span><span class="w">          </span>node.py:329
<span class="w">                    </span>INFO<span class="w">     </span>Saving<span class="w"> </span>data<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;X_train&#39;</span><span class="w"> </span><span class="o">(</span>MemoryDataSet<span class="o">)</span>...<span class="w">                                                         </span>data_catalog.py:382
<span class="w">                    </span>INFO<span class="w">     </span>Saving<span class="w"> </span>data<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;X_test&#39;</span><span class="w"> </span><span class="o">(</span>MemoryDataSet<span class="o">)</span>...<span class="w">                                                          </span>data_catalog.py:382
<span class="w">                    </span>INFO<span class="w">     </span>Saving<span class="w"> </span>data<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;y_train&#39;</span><span class="w"> </span><span class="o">(</span>MemoryDataSet<span class="o">)</span>...<span class="w">                                                         </span>data_catalog.py:382
<span class="w">                    </span>INFO<span class="w">     </span>Saving<span class="w"> </span>data<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;y_test&#39;</span><span class="w"> </span><span class="o">(</span>MemoryDataSet<span class="o">)</span>...<span class="w">                                                          </span>data_catalog.py:382
<span class="w">                    </span>INFO<span class="w">     </span>Completed<span class="w"> </span><span class="m">1</span><span class="w"> </span>out<span class="w"> </span>of<span class="w"> </span><span class="m">3</span><span class="w"> </span>tasks<span class="w">                                                                      </span>sequential_runner.py:85
<span class="w">                    </span>INFO<span class="w">     </span>Loading<span class="w"> </span>data<span class="w"> </span>from<span class="w"> </span><span class="s1">&#39;X_train&#39;</span><span class="w"> </span><span class="o">(</span>MemoryDataSet<span class="o">)</span>...<span class="w">                                                      </span>data_catalog.py:343
<span class="w">                    </span>INFO<span class="w">     </span>Loading<span class="w"> </span>data<span class="w"> </span>from<span class="w"> </span><span class="s1">&#39;X_test&#39;</span><span class="w"> </span><span class="o">(</span>MemoryDataSet<span class="o">)</span>...<span class="w">                                                       </span>data_catalog.py:343
<span class="w">                    </span>INFO<span class="w">     </span>Loading<span class="w"> </span>data<span class="w"> </span>from<span class="w"> </span><span class="s1">&#39;y_train&#39;</span><span class="w"> </span><span class="o">(</span>MemoryDataSet<span class="o">)</span>...<span class="w">                                                      </span>data_catalog.py:343
<span class="w">                    </span>INFO<span class="w">     </span>Running<span class="w"> </span>node:<span class="w"> </span>make_predictions:<span class="w"> </span>make_predictions<span class="o">([</span>X_train,X_test,y_train<span class="o">])</span><span class="w"> </span>-&gt;<span class="w"> </span><span class="o">[</span>y_pred<span class="o">]</span><span class="w">                      </span>node.py:329
...
</pre></div>
</div>
<p>You can see that the intermediate data is shared with memory. When kedro is deploy to a cluster, e.g.,
to <a class="reference external" href="https://docs.kedro.org/en/stable/deployment/argo.html#how-to-run-your-kedro-pipeline-using-argo-workflows">argo workflow</a>, the <code class="docutils literal notranslate"><span class="pre">MemoryDataSet</span></code> is not applicable anymore and you will need to setup the
AWS S3 or Minio service and sharing those intermediate data as CSV files.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">X_train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pandas.CSVDataSet</span>
<span class="w">  </span><span class="nt">filepath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://testing/data/02_intermediate/X_train.csv</span>
<span class="w">  </span><span class="nt">credentials</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">minio</span>

<span class="nt">X_test</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pandas.CSVDataSet</span>
<span class="w">  </span><span class="nt">filepath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://testing/data/02_intermediate/X_test.csv</span>
<span class="w">  </span><span class="nt">credentials</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">minio</span>

<span class="nt">y_train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pandas.CSVDataSet</span>
<span class="w">  </span><span class="nt">filepath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://testing/data/02_intermediate/y_train.csv</span>
<span class="w">  </span><span class="nt">credentials</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">minio</span>
</pre></div>
</div>
<p>It might be inefficient for pickling pandas dataframes when data become larger. With the kedro
vineyard plugin, you can run the pipeline with vineyard as the intermediate data medium by</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>kedro<span class="w"> </span>run<span class="w"> </span>--runner<span class="w"> </span>vineyard.contrib.kedro.runner.SequentialRunner
<span class="o">[</span><span class="m">05</span>/25/23<span class="w"> </span><span class="m">11</span>:45:34<span class="o">]</span><span class="w"> </span>INFO<span class="w">     </span>Kedro<span class="w"> </span>project<span class="w"> </span>iris<span class="w">                                                                                       </span>session.py:355
<span class="w">                    </span>INFO<span class="w">     </span>Loading<span class="w"> </span>data<span class="w"> </span>from<span class="w"> </span><span class="s1">&#39;example_iris_data&#39;</span><span class="w"> </span><span class="o">(</span>CSVDataSet<span class="o">)</span>...<span class="w">                                               </span>data_catalog.py:343
<span class="w">                    </span>INFO<span class="w">     </span>Loading<span class="w"> </span>data<span class="w"> </span>from<span class="w"> </span><span class="s1">&#39;parameters&#39;</span><span class="w"> </span><span class="o">(</span>MemoryDataSet<span class="o">)</span>...<span class="w">                                                   </span>data_catalog.py:343
<span class="w">                    </span>INFO<span class="w">     </span>Running<span class="w"> </span>node:<span class="w"> </span>split:<span class="w"> </span>split_data<span class="o">([</span>example_iris_data,parameters<span class="o">])</span><span class="w"> </span>-&gt;<span class="w"> </span><span class="o">[</span>X_train,X_test,y_train,y_test<span class="o">]</span><span class="w">          </span>node.py:329
<span class="w">                    </span>INFO<span class="w">     </span>Saving<span class="w"> </span>data<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;X_train&#39;</span><span class="w"> </span><span class="o">(</span>VineyardDataSet<span class="o">)</span>...<span class="w">                                                       </span>data_catalog.py:382
<span class="w">                    </span>INFO<span class="w">     </span>Saving<span class="w"> </span>data<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;X_test&#39;</span><span class="w"> </span><span class="o">(</span>VineyardDataSet<span class="o">)</span>...<span class="w">                                                        </span>data_catalog.py:382
<span class="w">                    </span>INFO<span class="w">     </span>Saving<span class="w"> </span>data<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;y_train&#39;</span><span class="w"> </span><span class="o">(</span>VineyardDataSet<span class="o">)</span>...<span class="w">                                                       </span>data_catalog.py:382
<span class="w">                    </span>INFO<span class="w">     </span>Saving<span class="w"> </span>data<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;y_test&#39;</span><span class="w"> </span><span class="o">(</span>VineyardDataSet<span class="o">)</span>...<span class="w">                                                        </span>data_catalog.py:382
<span class="w">                    </span>INFO<span class="w">     </span>Loading<span class="w"> </span>data<span class="w"> </span>from<span class="w"> </span><span class="s1">&#39;X_train&#39;</span><span class="w"> </span><span class="o">(</span>VineyardDataSet<span class="o">)</span>...<span class="w">                                                    </span>data_catalog.py:343
<span class="w">                    </span>INFO<span class="w">     </span>Loading<span class="w"> </span>data<span class="w"> </span>from<span class="w"> </span><span class="s1">&#39;X_test&#39;</span><span class="w"> </span><span class="o">(</span>VineyardDataSet<span class="o">)</span>...<span class="w">                                                     </span>data_catalog.py:343
<span class="w">                    </span>INFO<span class="w">     </span>Loading<span class="w"> </span>data<span class="w"> </span>from<span class="w"> </span><span class="s1">&#39;y_train&#39;</span><span class="w"> </span><span class="o">(</span>VineyardDataSet<span class="o">)</span>...<span class="w">                                                    </span>data_catalog.py:343
<span class="w">                    </span>INFO<span class="w">     </span>Running<span class="w"> </span>node:<span class="w"> </span>make_predictions:<span class="w"> </span>make_predictions<span class="o">([</span>X_train,X_test,y_train<span class="o">])</span><span class="w"> </span>-&gt;<span class="w"> </span><span class="o">[</span>y_pred<span class="o">]</span><span class="w">                      </span>node.py:329
...
</pre></div>
</div>
<p>Without any modification to your pipeline code, you can see that the intermediate data is shared
with vineyard using the <code class="docutils literal notranslate"><span class="pre">VineyardDataSet</span></code> and no longer suffers from the overhead of (de)serialization
and the I/O cost between external AWS S3 or Minio services.</p>
<p>Like <code class="docutils literal notranslate"><span class="pre">kedro</span> <span class="pre">catalog</span> <span class="pre">create</span></code>, the Kedro vineyard plugin provides a command-line interface to generate
the catalog configuration for given pipeline, which will rewrite the unspecified intermediate data
to <code class="docutils literal notranslate"><span class="pre">VineyardDataSet</span></code>, e.g.,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>kedro<span class="w"> </span>vineyard<span class="w"> </span>catalog<span class="w"> </span>create<span class="w"> </span>-p<span class="w"> </span>__default__
</pre></div>
</div>
<p>You will get</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">X_test</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ds_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">X_test</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vineyard.contrib.kedro.io.dataset.VineyardDataSet</span>
<span class="nt">X_train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ds_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">X_train</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vineyard.contrib.kedro.io.dataset.VineyardDataSet</span>
<span class="nt">y_pred</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ds_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">y_pred</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vineyard.contrib.kedro.io.dataset.VineyardDataSet</span>
<span class="nt">y_test</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ds_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">y_test</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vineyard.contrib.kedro.io.dataset.VineyardDataSet</span>
<span class="nt">y_train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ds_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">y_train</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vineyard.contrib.kedro.io.dataset.VineyardDataSet</span>
</pre></div>
</div>
</section>
<section id="deploy-to-kubernetes">
<h2>Deploy to Kubernetes<a class="headerlink" href="#deploy-to-kubernetes" title="Link to this heading">¶</a></h2>
<p>When the pipeline scales to Kubernetes, the interaction with the Kedro vineyard plugin is
still simple and non-intrusive. The plugin provides tools to prepare the docker image and
generate Argo workflow specification file for the Kedro pipeline. Next, we’ll demonstrate
how to deploy pipelines to Kubernetes while leverage Vineyard for efficient intermediate
sharing between tasks step-by-step.</p>
<ol class="arabic">
<li><p>Prepare the vineyard cluster (see also <a class="reference external" href="https://v6d.io/notes/cloud-native/deploy-kubernetes.html">Deploy on Kubernetes</a>):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># export your kubeconfig path here</span>
$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">KUBECONFIG</span><span class="o">=</span>/path/to/your/kubeconfig

<span class="c1"># install the vineyard operator</span>
$<span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>k8s/cmd/main.go<span class="w"> </span>deploy<span class="w"> </span>vineyard-cluster<span class="w"> </span>--create-namespace
</pre></div>
</div>
</li>
<li><p>Install the argo server:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># install the argo server</span>
$<span class="w"> </span>kubectl<span class="w"> </span>create<span class="w"> </span>namespace<span class="w"> </span>argo
$<span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-n<span class="w"> </span>argo<span class="w"> </span>-f<span class="w"> </span>https://github.com/argoproj/argo-workflows/releases/download/v3.4.8/install.yaml
</pre></div>
</div>
</li>
<li><p>Generate the iris demo project from the official template:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>kedro<span class="w"> </span>new<span class="w"> </span>--starter<span class="o">=</span>pandas-iris
</pre></div>
</div>
</li>
<li><p>Build the Docker image for this iris demo project:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># walk to the iris demo root directory</span>
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>iris
$<span class="w"> </span>kedro<span class="w"> </span>vineyard<span class="w"> </span>docker<span class="w"> </span>build
</pre></div>
</div>
<p>A Docker image named <code class="docutils literal notranslate"><span class="pre">iris</span></code> will be built successfully. The docker image
need to be pushed to your image registry, or loaded to the kind/minikube cluster, to be
available in Kubernetes.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>docker<span class="w"> </span>images<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>iris
iris<span class="w">   </span>latest<span class="w">   </span>3c92da8241c6<span class="w">   </span>About<span class="w"> </span>a<span class="w"> </span>minute<span class="w"> </span>ago<span class="w">   </span>690MB
</pre></div>
</div>
</li>
<li><p>Next, generate the Argo workflow YAML file from the iris demo project:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>kedro<span class="w"> </span>vineyard<span class="w"> </span>argo<span class="w"> </span>generate<span class="w"> </span>-i<span class="w"> </span>iris

<span class="c1"># check the generated Argo workflow YAML file, you can see the Argo workflow YAML file named `iris.yaml`</span>
<span class="c1"># is generated successfully.</span>
$<span class="w"> </span>ls<span class="w"> </span>-l<span class="w"> </span>argo-iris.yml
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">3685</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">23</span>:55<span class="w"> </span>argo-iris.yml
</pre></div>
</div>
</li>
<li><p>Finally, submit the Argo workflow to Kubernetes:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>argo<span class="w"> </span>submit<span class="w"> </span>-n<span class="w"> </span>argo<span class="w"> </span>argo-iris.yml
</pre></div>
</div>
<p>You can interact with the Argo workflow using the <code class="docutils literal notranslate"><span class="pre">argo</span></code> command-line tool, e.g.,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>argo<span class="w"> </span>list<span class="w"> </span>workflows<span class="w"> </span>-n<span class="w"> </span>argo
NAME<span class="w">         </span>STATUS<span class="w">      </span>AGE<span class="w">   </span>DURATION<span class="w">   </span>PRIORITY<span class="w">   </span>MESSAGE
iris-sg6qf<span class="w">   </span>Succeeded<span class="w">   </span>18m<span class="w">   </span>30s<span class="w">        </span><span class="m">0</span>
</pre></div>
</div>
</li>
</ol>
<p>We have prepared a benchmark to evaluate the performance gain brought by vineyard for data
sharing when data scales, for more details, please refer to <a class="reference external" href="https://v6d.io/tutorials/data-processing/accelerate-data-sharing-in-kedro.html">this report</a>.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
<div class="related-pages">
  <a class="next-page" href="../references.html">
      <div class="page-info">
        <div class="context">
          <span>Next</span>
        </div>
        <div class="title">API Reference</div>
      </div>
      <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
    </a>
  <a class="prev-page" href="airflow.html">
      <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
      <div class="page-info">
        <div class="context">
          <span>Previous</span>
        </div>
        
        <div class="title">Airflow on Vineyard</div>
        
      </div>
    </a>
</div>

<!-- index page doesn't have prev -->
  <hr/>

  <script src="https://giscus.app/client.js"
    data-repo="v6d-io/v6d"
    data-repo-id="MDEwOlJlcG9zaXRvcnkzMDY2MzEyMTE="
    data-category="General"
    data-category-id="MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMyNDA3MTg2"
    data-mapping="pathname"
    data-strict="1"
    data-reactions-enabled="0"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="light"
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
  </script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6CYXWKLJB8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6CYXWKLJB8');
</script>

<div class="bottom-of-page">
  <div class="left-details">
    <div class="copyright">
        Copyright &#169; 2020-2023, The Vineyard Authors
    </div>
    Rendered with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a href="https://github.com/pradyunsg/furo">Furo</a>
    <p>The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation,
       please see our <a href="https://www.linuxfoundation.org/trademark-usage/">Trademark Usage page</a>.
    </p>
  </div>
  <div class="right-details">
    <div class="icons"><a class="muted-link" href="https://github.com//" aria-label="On GitHub">
        <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
        <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
        </svg>
      </a>
    </div>
    <div>
      <a href="https://www.cncf.io/sandbox-projects/"><img src="https://v6d.io/_static/cncf-color.svg" alt="CLOUD NATIVE COMPUTING FOUNDATION" width="100%" style="max-width: 200px;"/></p>
    </div>
  </div>
</div>

      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal">Kedro Vineyard Plugin</a><ul>
<li><a class="reference internal" href="#kedro-on-vineyard">Kedro on Vineyard</a></li>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
<li><a class="reference internal" href="#usage">Usage</a></li>
<li><a class="reference internal" href="#deploy-to-kubernetes">Deploy to Kubernetes</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=8a448e45"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=c7037924"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>